{% extends "base.html" %}
{% block head %}
<title>ToDo</title>
{{ super() }}
<link href="../static/simple-sidebar.css" rel="stylesheet">
<style>
    #nav{
        margin-bottom: 0px;
    }

    #projects{

    }
</style>
{% endblock %}
{% block body %}
<div id="wrapper">
    <div id="sidebar-wrapper">
        <ul class="sidebar-nav">
            <li class="sidebar-brand">
                <a href="#">Your Lists</a>
            </li>
            <ul class="nav nav-pills nav-stacked" id="projects">
                    <li><a href="#">Project 0</a></li>
                    <li><a href="#">Project 0</a></li>
                    <li><button type="button" id="." class="btn btn-default"> +
                    </button>
                    <li style="visibility: hidden;"><a href="#">Project 3</a></li>
            </ul>
        </ul>
    </div>
    <div id="page-content-wrapper">
        <div class="container-fluid">
            <h1 align="center">List name</h1>
            <div class="col-lg-6" id="left">
                <h2 align="center">Tasks</h2>
                <div class="input-group">
                    <button type="button" id="" class="btn btn-default"
                        onclick="addTask(-1)"> + </button>
                    <!--
                    <button class="input-group-addon" id="plus-addon">+</button>
                    <input class="form-control" type="text" required
                    name="task" id="task" placeholder="Add a task"
                    autocomplete="off" /> -->
                </div>
                <br>

                <div class="panel-group">
                    {% for task in tasks recursive %}
                        <br>
                        <div style="position: relative; left: 30px;">

                                <!-- TODO: REPLACE <b> WITH THE TASK DIV -->
                            <div class="panel panel-default">
                                <div class="panel-body">
                                    Task: {{ task.title }} </b> <br>
                                    <span class="glyphicon glyphicon-cog pull-right"></span>
                                    <button type="button" id="" class="btn btn-default"
                                        onclick="addTask({{ task.tid}} )"> + </button>
                                </div>
                            </div>
                            {% if task.children and task.children|length != 0 %}
                                {{ loop(task.children) }} </ul>
                            {% endif %}
                        </div>

                    {% endfor %}
                </div>
                <!--<div class="panel-group">
                    <div class="panel panel-default">
                        <div class="panel-body">
                            <input type="checkbox" name="stuff">
                            TASK 1
                            can have this pull up pop up
                            <span class="glyphicon glyphicon-cog pull-right"></span>
                        </div>
                    </div>
                    <div class="panel panel-default">
                        <div class="panel-body">
                            <input type="checkbox" name="stuff">
                            TASK 2
                            can have this pull up pop up
                            <span class="glyphicon glyphicon-cog pull-right"></span>
                        </div>
                    </div>
                </div> -->
                {# YOU CAN CHANGE THIS PART
                {% for task in task_list %}
                <div><input type="checkbox" name="something">{{ task }}</div>
                {% endfor %}#}
            </div>
            <div class="col-lg-6" id="right">
                <h2 align="center">Completed</h2>
                <!-- ADD THE COMPLETED SHIT HERE -->
            </div>
        </div>
    </div>

    <div class="modal fade" id="newTaskModal" role="dialog">
        <div class="modal-dialog">

            <div class="modal-content">
                <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal">
                            x
                        </button>
                        <h2 class="modal-title"> New Task </h2>
                    </form>
                </div>
                <div class="modal-body">
                    <form id="task_form">
                        Title: <br>
                        <input class="form-control" type="text" required
                        name="title" id="modalInputName" placeholder="New Task" autocomplete="off"/>
                        <input id="task_form_submit" type="submit" class="btn btn-default"
                        data-dismiss="modal" value="Add Task">
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>



<!-- Menu Toggle Script -->
<script>
    var global_parent = -1; // SCOUT REPORTS THE JANK LEVEL: IT'S OVER9000!

    $("#menu-toggle").click(function (e) {
        e.preventDefault();
        $("#wrapper").toggleClass("toggled");
    });

    var addTask = function(task) {
        global_parent = task;
        $("#newTaskModal").modal();
    }

    $("#task_form_submit").click(function() {
        var data = $("#task_form").serializeObject();
        console.log("aylmao");
        data["parent"] = global_parent;

        api_call("POST","/api/tasks/add", data,
        function() {
            console.log(
                "Worked! \n" +
                "Sent: \n" +
                JSON.stringify(data)
            );
        },
        function() {
            console.log(
                "Failed :( \n" +
                "Sent \n" +
                JSON.stringify(data)
            );
        });
    });
</script>
{% endblock %}
